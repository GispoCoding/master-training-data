<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<link rel="icon" href="/master-training-data/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/master-training-data/favicon.ico" type="image/x-icon">

<!-- Based on TemplateMo 553 Xtra Blog: https://templatemo.com/tm-553-xtra-blog -->

<meta name="robots" content="noindex, nofollow" />
<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Exercise 4: GUIs with Qt | QGIS plugin development" />
<meta property="og:type" content="book" />





<meta name="author" content="Gispo Suomi Oy" />

<meta name="date" content="2025-10-31" />


<meta name="description" content="Exercise 4: GUIs with Qt | QGIS plugin development">

<title>Exercise 4: GUIs with Qt | QGIS plugin development</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="custom.css" type="text/css" />

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/hamburgers.css" rel="stylesheet">

</head>

<body>


<div class="main-content">
<!-- special comment to mark beginning of title section for bookdown -->
<!-- bookdown comments must be in this order: title, toc, body -->

<div class="main-content-wrapper">

<div class="row">
<div class="col-sm-12">
<header class="main-toc sidebar" id="sidebar">
<div class="sidebar-wrapper">

<button class="navbar-toggle hamburger hamburger--collapse" id="navbar-toggle"
type="button" onclick="navToggle()" aria-label="Toggle navigation">
<span class="hamburger-box"><span class="hamburger-inner"></span></span>
</button>

<div class="sidebar-title-wrapper">
<img alt="Logo" width="100" src="img/gispo_white_sm.png" class="sidebar-logo">
<div class="sidebar-title"><h1>QGIS plugin development</h1></div>
<div class="abstract-sidebar"><p>Developing plugins for QGIS using Python</p></div>
</div>

<nav class="sidebar-nav">
<div id="TOC" class="toc">
<ul>
<li class="has-sub"><a href="index.html#qgis-plugin-development">QGIS plugin development</a>
<ul>
<li><a href="index.html#welcome-to-the-course">Welcome to the course!</a></li>
<li><a href="index.html#reading-guide">Reading Guide</a></li>
<li><a href="index.html#additional-information">Additional information</a></li>
<li><a href="index.html#mistakes">Mistakes</a></li>
<li><a href="index.html#license-and-permissions">License and permissions</a></li>
<li><a href="index.html#download-a-pdf-version-of-the-material">Download a PDF version of the material</a></li>
</ul></li>
<li class="has-sub"><a href="00_exercise_0.html#exercise-0-python-basics">Exercise 0: Python basics</a>
<ul>
<li><a href="00_exercise_0.html#preparations">Preparations</a></li>
<li class="has-sub"><a href="00_exercise_0.html#the-basics">The basics</a>
<ul>
<li><a href="00_exercise_0.html#commands">Commands</a></li>
<li><a href="00_exercise_0.html#comments">Comments</a></li>
<li><a href="00_exercise_0.html#calculations">Calculations</a></li>
<li><a href="00_exercise_0.html#variables">Variables</a></li>
<li><a href="00_exercise_0.html#types">Types</a></li>
<li><a href="00_exercise_0.html#conditionals">Conditionals</a></li>
<li><a href="00_exercise_0.html#functions">Functions</a></li>
<li><a href="00_exercise_0.html#data-structures">Data structures</a></li>
<li><a href="00_exercise_0.html#loops-and-iteration">Loops and iteration</a></li>
<li><a href="00_exercise_0.html#modules">Modules</a></li>
<li><a href="00_exercise_0.html#objects">Objects</a></li>
<li><a href="00_exercise_0.html#classes">Classes</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="01_exercise_1.html#exercise-1-python-console">Exercise 1: Python console</a>
<ul>
<li><a href="01_exercise_1.html#structure-of-the-exercises">Structure of the exercises</a></li>
<li><a href="01_exercise_1.html#examples">Examples</a></li>
<li><a href="01_exercise_1.html#exercises">Exercises</a></li>
<li><a href="01_exercise_1.html#exercise-1.1">Exercise 1.1</a></li>
</ul></li>
<li class="has-sub"><a href="02_exercise_2.html#exercise-2-introduction-to-pyqgis">Exercise 2: Introduction to PyQGIS</a>
<ul>
<li><a href="02_exercise_2.html#layers">Layers</a></li>
<li><a href="02_exercise_2.html#exercise-2.1">Exercise 2.1</a></li>
<li><a href="02_exercise_2.html#exercise-2.2">Exercise 2.2</a></li>
<li><a href="02_exercise_2.html#exercise-2.3">Exercise 2.3</a></li>
</ul></li>
<li class="has-sub"><a href="03_exercise_3.html#exercise-3-layers-features-and-geometries">Exercise 3: Layers, features and geometries</a>
<ul>
<li><a href="03_exercise_3.html#layer">Layer</a></li>
<li><a href="03_exercise_3.html#creating-a-temporary-layer">Creating a temporary layer</a></li>
<li><a href="03_exercise_3.html#geometries">Geometries</a></li>
<li><a href="03_exercise_3.html#exercise-3.1">Exercise 3.1</a></li>
<li><a href="03_exercise_3.html#exercise-3.2-distances">Exercise 3.2: Distances</a></li>
</ul></li>
<li class="has-sub"><a href="04_exercise_4.html#exercise-4-guis-with-qt">Exercise 4: GUIs with Qt</a>
<ul>
<li class="has-sub"><a href="04_exercise_4.html#about-qt-guis">About Qt GUIs</a>
<ul>
<li><a href="04_exercise_4.html#qwidget">QWidget</a></li>
<li><a href="04_exercise_4.html#signals-and-slots">Signals and slots</a></li>
</ul></li>
<li><a href="04_exercise_4.html#exercise-4.1-counter-widget">Exercise 4.1: Counter-widget</a></li>
<li><a href="04_exercise_4.html#exercise-4.2-qgis-custom-widgets">Exercise 4.2: QGIS custom widgets</a></li>
</ul></li>
<li class="has-sub"><a href="05_exercise_5.html#exercise-5-creating-a-plugin">Exercise 5: Creating a plugin</a>
<ul>
<li><a href="05_exercise_5.html#configuring-git">Configuring Git</a></li>
<li><a href="05_exercise_5.html#creating-the-plugin">Creating the plugin</a></li>
<li><a href="05_exercise_5.html#adding-the-plugin-to-qgis">Adding the plugin to QGIS</a></li>
<li class="has-sub"><a href="05_exercise_5.html#structure-of-the-plugin">Structure of the plugin</a>
<ul>
<li><a href="05_exercise_5.html#file-plugin.py">File: plugin.py</a></li>
<li><a href="05_exercise_5.html#file-__init__.py">File: __init__.py</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="06_exercise_6.html#exercise-6-buffer-tool">Exercise 6: Buffer tool</a>
<ul>
<li><a href="06_exercise_6.html#exercise-6.1-creating-the-gui">Exercise 6.1: Creating the GUI</a></li>
<li><a href="06_exercise_6.html#exercise-6.2-connecting-the-gui-to-the-plugin">Exercise 6.2: Connecting the GUI to the plugin</a></li>
<li><a href="06_exercise_6.html#exercise-6.3-the-functionality-of-the-tool">Exercise 6.3: The functionality of the tool</a></li>
<li><a href="06_exercise_6.html#exercise-6.4-segments">Exercise 6.4: Segments</a></li>
<li><a href="06_exercise_6.html#unit-tests">Unit tests</a></li>
<li class="has-sub"><a href="06_exercise_6.html#exercise-6.5-tests">Exercise 6.5: Tests</a>
<ul>
<li><a href="06_exercise_6.html#exercise-6.5.1-gui-test">Exercise 6.5.1: GUI test</a></li>
<li><a href="06_exercise_6.html#exercise-6.5.2-buffertool-test">Exercise 6.5.2: BufferTool test</a></li>
<li><a href="06_exercise_6.html#exercise-6.5.3-more-tests">Exercise 6.5.3: More tests</a></li>
</ul></li>
<li><a href="06_exercise_6.html#sample-plugin">Sample plugin</a></li>
</ul></li>
<li class="has-sub"><a href="07_exercise_7.html#exercise-7-point-tool">Exercise 7: Point tool</a>
<ul>
<li><a href="07_exercise_7.html#exercise-7.1-creating-a-panel">Exercise 7.1: Creating a panel</a></li>
<li class="has-sub"><a href="07_exercise_7.html#exercise-7.2-point-tool">Exercise 7.2: Point Tool</a>
<ul>
<li><a href="07_exercise_7.html#exercise-7.2.1-extra-challenge---labeling">Exercise 7.2.1: Extra challenge - labeling</a></li>
</ul></li>
<li><a href="07_exercise_7.html#exercise-7.3-tests">Exercise 7.3: Tests</a></li>
</ul></li>
<li class="has-sub"><a href="08_exercise_8.html#exercise-8-processing-algorithms">Exercise 8: Processing algorithms</a>
<ul>
<li class="has-sub"><a href="08_exercise_8.html#background">Background</a>
<ul>
<li><a href="08_exercise_8.html#calling-a-processing-algorithm">Calling a processing algorithm</a></li>
</ul></li>
<li><a href="08_exercise_8.html#algorithms-in-a-plugin">Algorithms in a plugin</a></li>
<li><a href="08_exercise_8.html#exercise-8.1-writing-an-algorithm">Exercise 8.1: Writing an algorithm</a></li>
<li><a href="08_exercise_8.html#exercise-8.2-tests-for-the-algorithm">Exercise 8.2: Tests for the algorithm</a></li>
</ul></li>
<li class="has-sub"><a href="09_extra_9.html#extra-python-exercises">Extra Python exercises</a>
<ul>
<li class="has-sub"><a href="09_extra_9.html#topic-1-comprehensions">Topic 1: Comprehensions</a>
<ul>
<li><a href="09_extra_9.html#extra-exercise-1.1">Extra exercise 1.1</a></li>
<li><a href="09_extra_9.html#nested-comprehensions">Nested comprehensions</a></li>
</ul></li>
<li class="has-sub"><a href="09_extra_9.html#topic-2-lambda-functions">Topic 2: Lambda functions</a>
<ul>
<li><a href="09_extra_9.html#extra-exercise-2.1">Extra exercise 2.1</a></li>
</ul></li>
<li class="has-sub"><a href="09_extra_9.html#topic-3-decorators">Topic 3: Decorators</a>
<ul>
<li><a href="09_extra_9.html#extra-exercises-3.1">Extra exercises 3.1</a></li>
<li><a href="09_extra_9.html#decorators-and-parameters">Decorators and parameters</a></li>
<li><a href="09_extra_9.html#extra-exercise-3.2">Extra exercise 3.2</a></li>
</ul></li>
<li><a href="09_extra_9.html#topic-4-typing">Topic 4: Typing</a></li>
<li><a href="09_extra_9.html#extra-exercises-4.1">Extra exercises 4.1</a></li>
</ul></li>
</ul>
</div>
</nav>
</div>
</header>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="exercise-4-guis-with-qt" class="section level1">
<h1>Exercise 4: GUIs with Qt</h1>
<p><strong>Contents:</strong> The basics of PyQt.</p>
<p><strong>Goal:</strong> To understand how to create simple graphical user interfaces with PyQt.</p>
<div id="about-qt-guis" class="section level2">
<h2>About Qt GUIs</h2>
<p>The QGIS user interface is created using Qt, which is a collection
of libraries written in C++. It is likely most well-known for its
graphical user interface (GUI) library. Qt has several bindings
for different programming languages, such as Python.</p>
<div id="qwidget" class="section level3">
<h3>QWidget</h3>
<p>The Qt GUI library enables you to create GUIs. A central concept
in Qt is a “Widget”, which can be thought of as one component
of the GUI. In practice QWidget is a class which is inherited
by many other classes which are specialized for some specific
purpose. For example a <strong>QPushButton</strong> inherits QWidget and is a
clickable button in a GUI.</p>
<p>Some widgets work as containers and you can add <em>child widgets</em>
to them. These can be set to different layouts, for example
organized horizontally, vertically or in a grid. This lets you
organize the GUI.</p>
<p>By inheriting the QWidget class you can also write your own widgets
for some specialized purpose. QGIS has used this feature of Qt
and it has its own widgets that can also be used in plugins.
For example there are specific widgets for selecting layers or
CRSs.</p>
<p>Here is a minimal example of creating a GUI with PyQt. You can run
the example in the script editor.</p>
<button onclick="toggleAnswer(this)" class="btn answer_btn">
example
</button>
<div class="hidden-box">
<div class="code-box">
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="04_exercise_4.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the widget and resize</span></span>
<span id="cb110-2"><a href="04_exercise_4.html#cb110-2" aria-hidden="true" tabindex="-1"></a>widget <span class="op">=</span> QWidget()</span>
<span id="cb110-3"><a href="04_exercise_4.html#cb110-3" aria-hidden="true" tabindex="-1"></a>widget.resize(<span class="dv">420</span>, <span class="dv">320</span>)</span>
<span id="cb110-4"><a href="04_exercise_4.html#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="04_exercise_4.html#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vertical ayout and add it to the widget</span></span>
<span id="cb110-6"><a href="04_exercise_4.html#cb110-6" aria-hidden="true" tabindex="-1"></a>layout <span class="op">=</span> QVBoxLayout()</span>
<span id="cb110-7"><a href="04_exercise_4.html#cb110-7" aria-hidden="true" tabindex="-1"></a>widget.setLayout(layout)</span>
<span id="cb110-8"><a href="04_exercise_4.html#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="04_exercise_4.html#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create a button and add it to the layout</span></span>
<span id="cb110-10"><a href="04_exercise_4.html#cb110-10" aria-hidden="true" tabindex="-1"></a>button <span class="op">=</span> QPushButton(<span class="st">&quot;Close&quot;</span>)</span>
<span id="cb110-11"><a href="04_exercise_4.html#cb110-11" aria-hidden="true" tabindex="-1"></a>layout.addWidget(button)</span>
<span id="cb110-12"><a href="04_exercise_4.html#cb110-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-13"><a href="04_exercise_4.html#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="co"># show the widget.</span></span>
<span id="cb110-14"><a href="04_exercise_4.html#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="co"># if the widget is not a child of some other widget</span></span>
<span id="cb110-15"><a href="04_exercise_4.html#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="co"># it will be show in a new window</span></span>
<span id="cb110-16"><a href="04_exercise_4.html#cb110-16" aria-hidden="true" tabindex="-1"></a>widget.show()</span></code></pre></div>
</div>
</div>
<p>In this example we create a <strong>Close</strong> button. However when clicked it doesn’t do anything.</p>
</div>
<div id="signals-and-slots" class="section level3">
<h3>Signals and slots</h3>
<p>Another central idea in the Qt library are <strong>signals</strong> and <strong>slots</strong>. These enable
you to define the interactivity of the GUI, so that when clicking a QPushButton
a pre-defined action takes place.</p>
<p>When you interact with widgets, they <em>emit</em> different <strong>signals</strong> which can be
connected to a <strong>slot</strong> in the same or any other widget. The base Qt Widgets
already have many defined signals and slots, which you can utilize by creating
<strong>connections</strong> between the signals and slots. You can also define your own
signals and slots.</p>
<p>In PyQt a signal is an object of type <strong>Signal</strong> whereas a slot is a function
that can be connected to a signal. You can then <strong>emit</strong> the signal wherever
you want.</p>
<p>Here’s an example of creating a connection, using the previous example as a base:</p>
<button onclick="toggleAnswer(this)" class="btn answer_btn">
example
</button>
<div class="hidden-box">
<div class="code-box">
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="04_exercise_4.html#cb111-1" aria-hidden="true" tabindex="-1"></a>widget <span class="op">=</span> QWidget()</span>
<span id="cb111-2"><a href="04_exercise_4.html#cb111-2" aria-hidden="true" tabindex="-1"></a>widget.resize(<span class="dv">420</span>, <span class="dv">320</span>)</span>
<span id="cb111-3"><a href="04_exercise_4.html#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="04_exercise_4.html#cb111-4" aria-hidden="true" tabindex="-1"></a>layout <span class="op">=</span> QVBoxLayout()</span>
<span id="cb111-5"><a href="04_exercise_4.html#cb111-5" aria-hidden="true" tabindex="-1"></a>widget.setLayout(layout)</span>
<span id="cb111-6"><a href="04_exercise_4.html#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="04_exercise_4.html#cb111-7" aria-hidden="true" tabindex="-1"></a>button <span class="op">=</span> QPushButton(<span class="st">&quot;Close&quot;</span>)</span>
<span id="cb111-8"><a href="04_exercise_4.html#cb111-8" aria-hidden="true" tabindex="-1"></a>layout.addWidget(button)</span>
<span id="cb111-9"><a href="04_exercise_4.html#cb111-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-10"><a href="04_exercise_4.html#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect the &quot;clicked&quot; signal of QPushButtons</span></span>
<span id="cb111-11"><a href="04_exercise_4.html#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="co"># to the &quot;close&quot; slot of QWidget</span></span>
<span id="cb111-12"><a href="04_exercise_4.html#cb111-12" aria-hidden="true" tabindex="-1"></a>button.clicked.<span class="ex">connect</span>(widget.close)</span>
<span id="cb111-13"><a href="04_exercise_4.html#cb111-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-14"><a href="04_exercise_4.html#cb111-14" aria-hidden="true" tabindex="-1"></a>widget.show()</span></code></pre></div>
</div>
</div>
<p>Now the button should actually close the window.</p>
</div>
</div>
<div id="exercise-4.1-counter-widget" class="section level2">
<h2>Exercise 4.1: Counter-widget</h2>
<p>Write a script that defines a new widget called <code>Counter</code>
which inherits QWidget. It has two child widgets: QLabel
and QPushButton. A QLabel is a text component. The Counter
widget has value that you can increment by clicking the
button. This value starts at 0 and is shown in the QLabel.</p>
<p><img src="img/exercise_4/image1.gif" /></p>
<p>You can use this as a base:</p>
<div class="code-box">
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="04_exercise_4.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Counter(QWidget):</span>
<span id="cb112-2"><a href="04_exercise_4.html#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>args):</span>
<span id="cb112-3"><a href="04_exercise_4.html#cb112-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Counter, <span class="va">self</span>).<span class="fu">__init__</span>(<span class="op">*</span>args)</span>
<span id="cb112-4"><a href="04_exercise_4.html#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="04_exercise_4.html#cb112-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create the widgets</span></span>
<span id="cb112-6"><a href="04_exercise_4.html#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="04_exercise_4.html#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">@pyqtSlot</span>()</span>
<span id="cb112-8"><a href="04_exercise_4.html#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> on_increase_clicked(<span class="va">self</span>):</span>
<span id="cb112-9"><a href="04_exercise_4.html#cb112-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb112-10"><a href="04_exercise_4.html#cb112-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-11"><a href="04_exercise_4.html#cb112-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> refresh_label(<span class="va">self</span>):</span>
<span id="cb112-12"><a href="04_exercise_4.html#cb112-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb112-13"><a href="04_exercise_4.html#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="04_exercise_4.html#cb112-14" aria-hidden="true" tabindex="-1"></a>counter <span class="op">=</span> Counter()</span>
<span id="cb112-15"><a href="04_exercise_4.html#cb112-15" aria-hidden="true" tabindex="-1"></a>counter.show()</span></code></pre></div>
</div>
<button onclick="toggleAnswer(this)" class="btn answer_btn">
hint
</button>
<div class="hidden-box">
<div class="code-box">
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="04_exercise_4.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Counter(QWidget):</span>
<span id="cb113-2"><a href="04_exercise_4.html#cb113-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>args):</span>
<span id="cb113-3"><a href="04_exercise_4.html#cb113-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Counter, <span class="va">self</span>).<span class="fu">__init__</span>(<span class="op">*</span>args)</span>
<span id="cb113-4"><a href="04_exercise_4.html#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="04_exercise_4.html#cb113-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># define a variable where the count is tracked</span></span>
<span id="cb113-6"><a href="04_exercise_4.html#cb113-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb113-7"><a href="04_exercise_4.html#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="04_exercise_4.html#cb113-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># create a horizontal layout for the widget</span></span>
<span id="cb113-9"><a href="04_exercise_4.html#cb113-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.layout <span class="op">=</span> QHBoxLayout()</span>
<span id="cb113-10"><a href="04_exercise_4.html#cb113-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-11"><a href="04_exercise_4.html#cb113-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label <span class="op">=</span> QLabel()</span>
<span id="cb113-12"><a href="04_exercise_4.html#cb113-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.button <span class="op">=</span> QPushButton(<span class="st">&quot;Increase&quot;</span>)</span>
<span id="cb113-13"><a href="04_exercise_4.html#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="04_exercise_4.html#cb113-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># how do you add the widgets to the layout?</span></span>
<span id="cb113-15"><a href="04_exercise_4.html#cb113-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>functino<span class="op">&gt;</span></span>
<span id="cb113-16"><a href="04_exercise_4.html#cb113-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>function<span class="op">&gt;</span></span>
<span id="cb113-17"><a href="04_exercise_4.html#cb113-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-18"><a href="04_exercise_4.html#cb113-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># how do you set the layout to this</span></span>
<span id="cb113-19"><a href="04_exercise_4.html#cb113-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># widget?</span></span>
<span id="cb113-20"><a href="04_exercise_4.html#cb113-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>function<span class="op">&gt;</span></span>
<span id="cb113-21"><a href="04_exercise_4.html#cb113-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-22"><a href="04_exercise_4.html#cb113-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># create a connection so that</span></span>
<span id="cb113-23"><a href="04_exercise_4.html#cb113-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the on_increase_clicked slot</span></span>
<span id="cb113-24"><a href="04_exercise_4.html#cb113-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># is run when the button is</span></span>
<span id="cb113-25"><a href="04_exercise_4.html#cb113-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pushed</span></span>
<span id="cb113-26"><a href="04_exercise_4.html#cb113-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>function<span class="op">&gt;</span></span>
<span id="cb113-27"><a href="04_exercise_4.html#cb113-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-28"><a href="04_exercise_4.html#cb113-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># refresh the label</span></span>
<span id="cb113-29"><a href="04_exercise_4.html#cb113-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>function<span class="op">&gt;</span></span>
<span id="cb113-30"><a href="04_exercise_4.html#cb113-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-31"><a href="04_exercise_4.html#cb113-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">@pyqtSlot</span>()</span>
<span id="cb113-32"><a href="04_exercise_4.html#cb113-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> on_increase_clicked(<span class="va">self</span>):</span>
<span id="cb113-33"><a href="04_exercise_4.html#cb113-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># increase the count and</span></span>
<span id="cb113-34"><a href="04_exercise_4.html#cb113-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># refresh the label</span></span>
<span id="cb113-35"><a href="04_exercise_4.html#cb113-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>function<span class="op">&gt;</span></span>
<span id="cb113-36"><a href="04_exercise_4.html#cb113-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>function<span class="op">&gt;</span></span>
<span id="cb113-37"><a href="04_exercise_4.html#cb113-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-38"><a href="04_exercise_4.html#cb113-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> refresh_label(<span class="va">self</span>):</span>
<span id="cb113-39"><a href="04_exercise_4.html#cb113-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># how do you set a new text for</span></span>
<span id="cb113-40"><a href="04_exercise_4.html#cb113-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the QLabel?</span></span>
<span id="cb113-41"><a href="04_exercise_4.html#cb113-41" aria-hidden="true" tabindex="-1"></a>        <span class="op">&lt;</span>function<span class="op">&gt;</span></span>
<span id="cb113-42"><a href="04_exercise_4.html#cb113-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-43"><a href="04_exercise_4.html#cb113-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-44"><a href="04_exercise_4.html#cb113-44" aria-hidden="true" tabindex="-1"></a>counter <span class="op">=</span> Counter()</span>
<span id="cb113-45"><a href="04_exercise_4.html#cb113-45" aria-hidden="true" tabindex="-1"></a>counter.show()</span></code></pre></div>
</div>
</div>
<button onclick="toggleAnswer(this)" class="btn answer_btn">
answer
</button>
<div class="hidden-box">
<div class="code-box">
<div class="sourceCode" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="04_exercise_4.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Counter(QWidget):</span>
<span id="cb114-2"><a href="04_exercise_4.html#cb114-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>args):</span>
<span id="cb114-3"><a href="04_exercise_4.html#cb114-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(Counter, <span class="va">self</span>).<span class="fu">__init__</span>(<span class="op">*</span>args)</span>
<span id="cb114-4"><a href="04_exercise_4.html#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="04_exercise_4.html#cb114-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb114-6"><a href="04_exercise_4.html#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="04_exercise_4.html#cb114-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.layout <span class="op">=</span> QHBoxLayout()</span>
<span id="cb114-8"><a href="04_exercise_4.html#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="04_exercise_4.html#cb114-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label <span class="op">=</span> QLabel()</span>
<span id="cb114-10"><a href="04_exercise_4.html#cb114-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.button <span class="op">=</span> QPushButton(<span class="st">&quot;Increase&quot;</span>)</span>
<span id="cb114-11"><a href="04_exercise_4.html#cb114-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-12"><a href="04_exercise_4.html#cb114-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.layout.addWidget(<span class="va">self</span>.label)</span>
<span id="cb114-13"><a href="04_exercise_4.html#cb114-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.layout.addWidget(<span class="va">self</span>.button)</span>
<span id="cb114-14"><a href="04_exercise_4.html#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="04_exercise_4.html#cb114-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setLayout(<span class="va">self</span>.layout)</span>
<span id="cb114-16"><a href="04_exercise_4.html#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="04_exercise_4.html#cb114-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.button.clicked.<span class="ex">connect</span>(<span class="va">self</span>.on_increase_clicked)</span>
<span id="cb114-18"><a href="04_exercise_4.html#cb114-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-19"><a href="04_exercise_4.html#cb114-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.refresh_label()</span>
<span id="cb114-20"><a href="04_exercise_4.html#cb114-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-21"><a href="04_exercise_4.html#cb114-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">@pyqtSlot</span>()</span>
<span id="cb114-22"><a href="04_exercise_4.html#cb114-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> on_increase_clicked(<span class="va">self</span>):</span>
<span id="cb114-23"><a href="04_exercise_4.html#cb114-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.count <span class="op">+=</span><span class="dv">1</span></span>
<span id="cb114-24"><a href="04_exercise_4.html#cb114-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.refresh_label()</span>
<span id="cb114-25"><a href="04_exercise_4.html#cb114-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-26"><a href="04_exercise_4.html#cb114-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> refresh_label(<span class="va">self</span>):</span>
<span id="cb114-27"><a href="04_exercise_4.html#cb114-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label.setText(<span class="bu">str</span>(<span class="va">self</span>.count))</span>
<span id="cb114-28"><a href="04_exercise_4.html#cb114-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-29"><a href="04_exercise_4.html#cb114-29" aria-hidden="true" tabindex="-1"></a>counter <span class="op">=</span> Counter()</span>
<span id="cb114-30"><a href="04_exercise_4.html#cb114-30" aria-hidden="true" tabindex="-1"></a>counter.show()</span></code></pre></div>
</div>
</div>
</div>
<div id="exercise-4.2-qgis-custom-widgets" class="section level2">
<h2>Exercise 4.2: QGIS custom widgets</h2>
<p>Create a GUI where the user can select a layer from the
QGIS project. By clicking a button a new polygon layer
is created which as one feature. This feature gets the
geometry which is a rectangular polygon which is calculated
from the extent of the selected layer.</p>
<p>Also save a fid identifier and as another attribute the
name of the layer from which the extent was calculated.
Create the new polygon layer with the CRS EPSG:4326 and,
if needed, transform the extent calculated from the source
layer to the same EPSG:4326 CRS. Use the <strong>QgsMapLayerComboBox</strong>
widget for selecting the layers.</p>
<p>You can calculate the extent from the layer object with the
<a href="https://qgis.org/pyqgis/latest/core/QgsMapLayer.html#qgis.core.QgsMapLayer.extent"><code>extent()</code> method</a>.
However it does not return a QgsGeometry object directly.
Find out what it returns and how you can create a geometry
object from it.</p>
<p><img src="img/exercise_4/image2.gif" /></p>
<p>You can use this as a base:</p>
<div class="code-box">
<div class="sourceCode" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="04_exercise_4.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LayerExtentWidget(QWidget):</span>
<span id="cb115-2"><a href="04_exercise_4.html#cb115-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>args):</span>
<span id="cb115-3"><a href="04_exercise_4.html#cb115-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(LayerExtentWidget, <span class="va">self</span>).<span class="fu">__init__</span>(<span class="op">*</span>args)</span>
<span id="cb115-4"><a href="04_exercise_4.html#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="04_exercise_4.html#cb115-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ...</span></span>
<span id="cb115-6"><a href="04_exercise_4.html#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="04_exercise_4.html#cb115-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">@pyqtSlot</span>()</span>
<span id="cb115-8"><a href="04_exercise_4.html#cb115-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> on_button_clicked(<span class="va">self</span>):</span>
<span id="cb115-9"><a href="04_exercise_4.html#cb115-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb115-10"><a href="04_exercise_4.html#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="04_exercise_4.html#cb115-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_layer(<span class="va">self</span>, layer: QgsMapLayer):</span>
<span id="cb115-12"><a href="04_exercise_4.html#cb115-12" aria-hidden="true" tabindex="-1"></a>        new_layer <span class="op">=</span> QgsVectorLayer(<span class="st">&quot;Polygon?crs=EPSG:4326&quot;</span>, <span class="ss">f&quot;extent: </span><span class="sc">{</span>layer<span class="sc">.</span>name()<span class="sc">}</span><span class="ss">&quot;</span>, <span class="st">&quot;memory&quot;</span>)</span>
<span id="cb115-13"><a href="04_exercise_4.html#cb115-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-14"><a href="04_exercise_4.html#cb115-14" aria-hidden="true" tabindex="-1"></a>        new_layer.startEditing()</span>
<span id="cb115-15"><a href="04_exercise_4.html#cb115-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-16"><a href="04_exercise_4.html#cb115-16" aria-hidden="true" tabindex="-1"></a>        new_layer.addAttribute(QgsField(<span class="st">&quot;fid&quot;</span>, QVariant.Int))</span>
<span id="cb115-17"><a href="04_exercise_4.html#cb115-17" aria-hidden="true" tabindex="-1"></a>        new_layer.addAttribute(QgsField(<span class="st">&quot;layer&quot;</span>, QVariant.String))</span>
<span id="cb115-18"><a href="04_exercise_4.html#cb115-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-19"><a href="04_exercise_4.html#cb115-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ...</span></span>
<span id="cb115-20"><a href="04_exercise_4.html#cb115-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-21"><a href="04_exercise_4.html#cb115-21" aria-hidden="true" tabindex="-1"></a>        new_layer.commitChanges()</span>
<span id="cb115-22"><a href="04_exercise_4.html#cb115-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-23"><a href="04_exercise_4.html#cb115-23" aria-hidden="true" tabindex="-1"></a>        QgsProject.instance().addMapLayer(new_layer)</span></code></pre></div>
</div>
<button onclick="toggleAnswer(this)" class="btn answer_btn">
answer
</button>
<div class="hidden-box">
<div class="code-box">
<div class="sourceCode" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="04_exercise_4.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LayerExtentWidget(QWidget):</span>
<span id="cb116-2"><a href="04_exercise_4.html#cb116-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>args):</span>
<span id="cb116-3"><a href="04_exercise_4.html#cb116-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(LayerExtentWidget, <span class="va">self</span>).<span class="fu">__init__</span>(<span class="op">*</span>args)</span>
<span id="cb116-4"><a href="04_exercise_4.html#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="04_exercise_4.html#cb116-5" aria-hidden="true" tabindex="-1"></a>        layout <span class="op">=</span> QHBoxLayout()</span>
<span id="cb116-6"><a href="04_exercise_4.html#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="04_exercise_4.html#cb116-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.layer_combobox <span class="op">=</span> QgsMapLayerComboBox()</span>
<span id="cb116-8"><a href="04_exercise_4.html#cb116-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.button <span class="op">=</span> QPushButton(<span class="st">&quot;Create Extent&quot;</span>)</span>
<span id="cb116-9"><a href="04_exercise_4.html#cb116-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-10"><a href="04_exercise_4.html#cb116-10" aria-hidden="true" tabindex="-1"></a>        layout.addWidget(<span class="va">self</span>.layer_combobox)</span>
<span id="cb116-11"><a href="04_exercise_4.html#cb116-11" aria-hidden="true" tabindex="-1"></a>        layout.addWidget(<span class="va">self</span>.button)</span>
<span id="cb116-12"><a href="04_exercise_4.html#cb116-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-13"><a href="04_exercise_4.html#cb116-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setLayout(layout)</span>
<span id="cb116-14"><a href="04_exercise_4.html#cb116-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-15"><a href="04_exercise_4.html#cb116-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.button.clicked.<span class="ex">connect</span>(<span class="va">self</span>.on_button_clicked)</span>
<span id="cb116-16"><a href="04_exercise_4.html#cb116-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-17"><a href="04_exercise_4.html#cb116-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.resize(<span class="dv">420</span>, <span class="dv">150</span>)</span>
<span id="cb116-18"><a href="04_exercise_4.html#cb116-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-19"><a href="04_exercise_4.html#cb116-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">@pyqtSlot</span>()</span>
<span id="cb116-20"><a href="04_exercise_4.html#cb116-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> on_button_clicked(<span class="va">self</span>):</span>
<span id="cb116-21"><a href="04_exercise_4.html#cb116-21" aria-hidden="true" tabindex="-1"></a>        layer <span class="op">=</span> <span class="va">self</span>.layer_combobox.currentLayer()</span>
<span id="cb116-22"><a href="04_exercise_4.html#cb116-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-23"><a href="04_exercise_4.html#cb116-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_layer(layer)</span>
<span id="cb116-24"><a href="04_exercise_4.html#cb116-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-25"><a href="04_exercise_4.html#cb116-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_layer(<span class="va">self</span>, layer: QgsMapLayer):</span>
<span id="cb116-26"><a href="04_exercise_4.html#cb116-26" aria-hidden="true" tabindex="-1"></a>        new_layer <span class="op">=</span> QgsVectorLayer(<span class="st">&quot;Polygon?crs=EPSG:4326&quot;</span>, <span class="ss">f&quot;extent: </span><span class="sc">{</span>layer<span class="sc">.</span>name()<span class="sc">}</span><span class="ss">&quot;</span>, <span class="st">&quot;memory&quot;</span>)</span>
<span id="cb116-27"><a href="04_exercise_4.html#cb116-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-28"><a href="04_exercise_4.html#cb116-28" aria-hidden="true" tabindex="-1"></a>        new_layer.startEditing()</span>
<span id="cb116-29"><a href="04_exercise_4.html#cb116-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-30"><a href="04_exercise_4.html#cb116-30" aria-hidden="true" tabindex="-1"></a>        new_layer.addAttribute(QgsField(<span class="st">&quot;fid&quot;</span>, QVariant.Int))</span>
<span id="cb116-31"><a href="04_exercise_4.html#cb116-31" aria-hidden="true" tabindex="-1"></a>        new_layer.addAttribute(QgsField(<span class="st">&quot;layer&quot;</span>, QVariant.String))</span>
<span id="cb116-32"><a href="04_exercise_4.html#cb116-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-33"><a href="04_exercise_4.html#cb116-33" aria-hidden="true" tabindex="-1"></a>        new_feature <span class="op">=</span> QgsFeature(new_layer.fields())</span>
<span id="cb116-34"><a href="04_exercise_4.html#cb116-34" aria-hidden="true" tabindex="-1"></a>        new_feature.setAttributes([<span class="dv">1</span>, layer.name()])</span>
<span id="cb116-35"><a href="04_exercise_4.html#cb116-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-36"><a href="04_exercise_4.html#cb116-36" aria-hidden="true" tabindex="-1"></a>        new_geom <span class="op">=</span> QgsGeometry.fromRect(layer.extent())</span>
<span id="cb116-37"><a href="04_exercise_4.html#cb116-37" aria-hidden="true" tabindex="-1"></a>        source_crs <span class="op">=</span> layer.crs()</span>
<span id="cb116-38"><a href="04_exercise_4.html#cb116-38" aria-hidden="true" tabindex="-1"></a>        target_crs <span class="op">=</span> QgsCoordinateReferenceSystem(<span class="dv">4326</span>)</span>
<span id="cb116-39"><a href="04_exercise_4.html#cb116-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-40"><a href="04_exercise_4.html#cb116-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source_crs <span class="op">!=</span> target_crs:</span>
<span id="cb116-41"><a href="04_exercise_4.html#cb116-41" aria-hidden="true" tabindex="-1"></a>            transform <span class="op">=</span> QgsCoordinateTransform(source_crs, target_crs, QgsProject.instance())</span>
<span id="cb116-42"><a href="04_exercise_4.html#cb116-42" aria-hidden="true" tabindex="-1"></a>            new_geom.transform(transform)</span>
<span id="cb116-43"><a href="04_exercise_4.html#cb116-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-44"><a href="04_exercise_4.html#cb116-44" aria-hidden="true" tabindex="-1"></a>        new_feature.setGeometry(new_geom)</span>
<span id="cb116-45"><a href="04_exercise_4.html#cb116-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-46"><a href="04_exercise_4.html#cb116-46" aria-hidden="true" tabindex="-1"></a>        new_layer.addFeature(new_feature)</span>
<span id="cb116-47"><a href="04_exercise_4.html#cb116-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-48"><a href="04_exercise_4.html#cb116-48" aria-hidden="true" tabindex="-1"></a>        new_layer.commitChanges()</span>
<span id="cb116-49"><a href="04_exercise_4.html#cb116-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-50"><a href="04_exercise_4.html#cb116-50" aria-hidden="true" tabindex="-1"></a>        QgsProject.instance().addMapLayer(new_layer)</span>
<span id="cb116-51"><a href="04_exercise_4.html#cb116-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-52"><a href="04_exercise_4.html#cb116-52" aria-hidden="true" tabindex="-1"></a>extent_widget <span class="op">=</span> LayerExtentWidget()</span>
<span id="cb116-53"><a href="04_exercise_4.html#cb116-53" aria-hidden="true" tabindex="-1"></a>extent_widget.show()</span></code></pre></div>
</div>
</div>

</div>
</div>
<p style="text-align: center;">
<a href="03_exercise_3.html"><button class="btn btn-default">Previous</button></a>
<a href="05_exercise_5.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>

<footer class="footer text-center">

<div class="footer-container text-center">

<div class="footer-info">
<h5 class="footer-title">QGIS plugin development</h5>
<span class="footer-version">v2025-10-31</span>
<div class="license"><img src="img/by-nd.svg" width="80px" alt="CC-BY-ND"></div>
</div>

<div class="footer-info">
<h5 class="footer-title footer-company">Gispo Finland Ltd.
<span class="footer-copyright-year">© 2025</span></h5>
<span class="footer-contact-info">Kyllikinportti 2
<br>00240 Helsinki, Finland
<br>info@gispo.fi
</span>
</div>

</div>
</div>
</footer>
</div>


<script src="js/nav-script.js"></script>
<script src="js/answer-key.js"></script>

</body>
</html>
