<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<link rel="icon" href="/master-training-data/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/master-training-data/favicon.ico" type="image/x-icon">

<!-- Based on TemplateMo 553 Xtra Blog: https://templatemo.com/tm-553-xtra-blog -->

<meta name="robots" content="noindex, nofollow" />
<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Exercise 7: Spatial analyses | Introduction to QGIS" />
<meta property="og:type" content="book" />





<meta name="author" content="Gispo Ltd." />

<meta name="date" content="2024-01-18" />


<meta name="description" content="Exercise 7: Spatial analyses | Introduction to QGIS">

<title>Exercise 7: Spatial analyses | Introduction to QGIS</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="custom.css" type="text/css" />

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/hamburgers.css" rel="stylesheet">

</head>

<body>


<div class="main-content">
<!-- special comment to mark beginning of title section for bookdown -->
<!-- bookdown comments must be in this order: title, toc, body -->

<div class="main-content-wrapper">

<div class="row">
<div class="col-sm-12">
<header class="main-toc sidebar" id="sidebar">
<div class="sidebar-wrapper">

<button class="navbar-toggle hamburger hamburger--collapse" id="navbar-toggle"
type="button" onclick="navToggle()" aria-label="Toggle navigation">
<span class="hamburger-box"><span class="hamburger-inner"></span></span>
</button>

<div class="sidebar-title-wrapper">
<img alt="Logo" width="100" src="img/gispo_white_sm.png" class="sidebar-logo">
<div class="sidebar-title"><h1>Introduction to QGIS</h1></div>
<div class="abstract-sidebar"><p>Basic course on QGIS</p></div>
</div>

<nav class="sidebar-nav">
<div id="TOC" class="toc">
<ul>
<li><a href="index.html#introduction-to-qgis">Introduction to QGIS</a></li>
<li class="has-sub"><a href="01_exercise_1.html#exercise-1-user-interface-of-qgis">Exercise 1: User interface of QGIS</a>
<ul>
<li><a href="01_exercise_1.html#downloading-course-materials">Downloading course materials</a></li>
<li><a href="01_exercise_1.html#qgis-user-interface">QGIS user interface</a></li>
<li><a href="01_exercise_1.html#try-the-tools-yourself">Try the tools yourself</a></li>
<li><a href="01_exercise_1.html#attribute-table">Attribute table</a></li>
</ul></li>
<li class="has-sub"><a href="02_exercise_2.html#exercise-2-geographic-data-and-online-data-services">Exercise 2: Geographic data and online data services</a>
<ul>
<li><a href="02_exercise_2.html#exercise-content">Exercise content</a></li>
<li><a href="02_exercise_2.html#the-goal-of-the-exercise">The goal of the exercise</a></li>
<li><a href="02_exercise_2.html#preparations">Preparations</a></li>
<li><a href="02_exercise_2.html#connecting-to-a-wms">Connecting to a WMS</a></li>
<li><a href="02_exercise_2.html#connecting-to-a-wfs">Connecting to a WFS</a></li>
<li><a href="02_exercise_2.html#bonus-building-sql-query-for-wfs">Bonus: Building SQL query for WFS</a></li>
</ul></li>
<li class="has-sub"><a href="03_exercise_3.html#exercise-3-visualizing-and-classifying-geographic-data-sets">Exercise 3: Visualizing and classifying geographic data sets</a>
<ul>
<li><a href="03_exercise_3.html#exercise-content-1">Exercise content</a></li>
<li><a href="03_exercise_3.html#the-goal-of-the-exercise-1">The goal of the exercise</a></li>
<li><a href="03_exercise_3.html#preparations-1">Preparations</a></li>
<li><a href="03_exercise_3.html#visualizing-vector-data">Visualizing vector data</a></li>
<li><a href="03_exercise_3.html#visualizing-line-data-sets">Visualizing line data sets</a></li>
<li><a href="03_exercise_3.html#visualizing-point-data-sets">Visualizing point data sets</a></li>
<li><a href="03_exercise_3.html#visualizing-polygon-data-sets">Visualizing polygon data sets</a></li>
<li><a href="03_exercise_3.html#changing-symbols">Changing symbols</a></li>
<li><a href="03_exercise_3.html#scale-dependent-symbols">Scale dependent symbols</a></li>
</ul></li>
<li class="has-sub"><a href="04_exercise_4.html#exercise-4-labeling-and-classifying-geographic-data">Exercise 4: Labeling and classifying geographic data</a>
<ul>
<li><a href="04_exercise_4.html#exercise-content-2">Exercise content</a></li>
<li><a href="04_exercise_4.html#the-goal-of-the-exercise-2">The goal of the exercise</a></li>
<li><a href="04_exercise_4.html#preparations-2">Preparations</a></li>
<li><a href="04_exercise_4.html#label-settings">Label settings</a></li>
<li><a href="04_exercise_4.html#styling-label-texts">Styling label texts</a></li>
<li><a href="04_exercise_4.html#labeling-line-layers">Labeling line layers</a></li>
<li><a href="04_exercise_4.html#classifying-vector-data">Classifying vector data</a></li>
<li><a href="04_exercise_4.html#bonus-classifying-raster-data">Bonus: Classifying raster data</a></li>
<li><a href="04_exercise_4.html#bonus-label-rendering">Bonus: Label rendering</a></li>
</ul></li>
<li class="has-sub"><a href="05_exercise_5.html#exercise-5-print-layout">Exercise 5: Print layout</a>
<ul>
<li><a href="05_exercise_5.html#exercise-content-3">Exercise content</a></li>
<li><a href="05_exercise_5.html#the-goal-of-the-exercise-3">The goal of the exercise</a></li>
<li><a href="05_exercise_5.html#preparations-3">Preparations</a></li>
<li><a href="05_exercise_5.html#print-layout">Print layout</a></li>
<li><a href="05_exercise_5.html#bonus-map-atlas">Bonus: Map atlas</a></li>
</ul></li>
<li class="has-sub"><a href="06_exercise_6.html#exercise-6-editing-geographic-data-sets">Exercise 6: Editing geographic data sets</a>
<ul>
<li><a href="06_exercise_6.html#exercise-content-4">Exercise content</a></li>
<li><a href="06_exercise_6.html#the-goal-of-the-exercise-4">The goal of the exercise</a></li>
<li><a href="06_exercise_6.html#preparations-4">Preparations</a></li>
<li><a href="06_exercise_6.html#creating-a-vector-data-set">Creating a vector data set</a></li>
<li><a href="06_exercise_6.html#editing-and-digitizing-vector-data">Editing and digitizing vector data</a></li>
<li><a href="06_exercise_6.html#adding-geometries">Adding geometries</a></li>
<li><a href="06_exercise_6.html#bonus-adding-attribute-information">Bonus: Adding attribute information</a></li>
</ul></li>
<li class="has-sub"><a href="07_exercise_7.html#exercise-7-spatial-analyses">Exercise 7: Spatial analyses</a>
<ul>
<li><a href="07_exercise_7.html#exercise-content-5">Exercise content</a></li>
<li><a href="07_exercise_7.html#the-goal-of-the-exercise-5">The goal of the exercise</a></li>
<li><a href="07_exercise_7.html#preparations-5">Preparations</a></li>
<li><a href="07_exercise_7.html#vector-analyses">Vector analyses</a></li>
</ul></li>
<li class="has-sub"><a href="08_exercise_8.html#exercise-8-plugins-in-qgis">Exercise 8: Plugins in QGIS</a>
<ul>
<li><a href="08_exercise_8.html#exercise-content-6">Exercise content</a></li>
<li><a href="08_exercise_8.html#the-goal-of-the-exercise-6">The goal of the exercise</a></li>
<li><a href="08_exercise_8.html#preparations-6">Preparations</a></li>
<li><a href="08_exercise_8.html#plugin-management">Plugin management</a></li>
<li><a href="08_exercise_8.html#quickmapservices">QuickMapServices</a></li>
<li><a href="08_exercise_8.html#bonus-qgis2threejs">Bonus: Qgis2threejs</a></li>
<li><a href="08_exercise_8.html#bonus-qgis2web">Bonus: Qgis2web</a></li>
</ul></li>
</ul>
</div>
</nav>
</div>
</header>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="exercise-7-spatial-analyses" class="section level1">
<h1>Exercise 7: Spatial analyses</h1>
<div id="exercise-content-5" class="section level2">
<h2>Exercise content</h2>
<p>This exercise focuses on simple spatial analyses with QGIS.</p>
</div>
<div id="the-goal-of-the-exercise-5" class="section level2">
<h2>The goal of the exercise</h2>
<p>After the exercise you have basic knowledge about spatial analyses using QGIS.</p>
</div>
<div id="preparations-5" class="section level2">
<h2>Preparations</h2>
<p>Open a new QGIS project (<strong>Project &gt; New</strong>) and save it as <strong>"QGIS-exercise 7"</strong>. Add the following data to the project:</p>
<ul>
<li><p><strong>..course_directory/natural_earth/rivers_world.shp</strong></p></li>
<li><p><strong>..course_directory/natural_earth/countries_world.shp</strong></p></li>
</ul>
<p>The map view should look like this:</p>
<p><img src="img/exercise_7/image1.png" /></p>
<p>Make sure that the CRS is set to <strong>WGS 84 (EPSG:4326)</strong>. You can check/change your project’s coordinate reference system (CRS) either by selecting <strong>Project &gt; Properties &gt; CRS</strong>) or by clicking the CRS button in the bottom left of QGIS:</p>
<p><img src="img/exercise_7/image2.png" /></p>
<p>Both methods open the project CRS window.</p>
<p>You can add data in multiple different coordinate reference systems to a single project, but <strong>many of the analysis tools produce false results or completely stop working</strong> if the data sets being analyzed are in different coordinate reference systems. In these cases the data must be exported to a common CRS. This time both data sets are in the same CRS (EPSG:4326), so we won't have problems.</p>
</div>
<div id="vector-analyses" class="section level2">
<h2>Vector analyses</h2>
<p>In this exercise our goal is to find out the countries through which the river Nile runs. In a nutshell, the exercise follows these steps:</p>
<ol style="list-style-type: decimal">
<li><p>We select the river Nile from the river data.</p></li>
<li><p>We do a spatial analysis with the rivers and countries data sets. In the analysis the river data set gets feature information from the country data set.</p></li>
<li><p>We dissolve the river sections by country name.</p></li>
</ol>
<p>Duplicate the <strong>rivers_world</strong> layer by right-clicking and selecting <strong>Duplicate Layer</strong>.Open the properties of the new <strong>rivers_world copy</strong> layer by double-clicking the layer. Select the Source tab and set the layer name as <strong>Nile</strong>. Let's now filter the layer features, or, in other words, select which features we want displayed. Right-click the <strong>Nile</strong> layer and select <strong>Filter...</strong>. Form the following expression into the <strong>Provide specific filter expression</strong> field:</p>
<div class="code-box">
<p>“name_en” = ‘Nile’ OR “name_en” = ‘White Nile’ OR “name_en” = ‘Blue Nile’</p>
</div>
<p>You can access field names easily by double clicking them in the <strong>Field</strong> section. Visualize the new layer with new symbology settings so that it stands out from the other rivers.</p>
<p>Let's now perform an <strong>intersection</strong> analysis with the <strong>Nile</strong> and <strong>countries_world</strong> layers. From the top menu bar choose <strong>Vector &gt; Geoprocessing tools &gt; Intersection</strong>. The intersection window opens. Set <strong>Nile</strong> as the input layer and <strong>counties_world</strong> as the overlay layer.</p>
<p><img src="img/exercise_7/image3.png" /></p>
<p>Run the analysis by pressing <strong>Run</strong> and after that press <strong>Close</strong>. A new temporary layer is created. In the map view the temporary layer looks just like the original layer.</p>
<div class="hint-box">
<p>Compare the attribute tables of the original Nile layer and the temporary intersection layer. What do you notice?</p>
</div>
<p>Classify the data based on country names using the field <strong>SOVEREIGNT</strong> (<strong>Properties &gt; Symbology &gt; Categorized</strong>). Activate the <strong>Show Feature Count</strong> option (Right-click the layer in the <strong>Layers Panel</strong>). The classification in the layers panel should now look something like the image below (Colors and line width are of course different):</p>
<p><img src="img/exercise_7/image4.png" /></p>
<p>Next we can combine the separate road lines with the <strong>Dissolve</strong> tool. Select <strong>Vector &gt;  Geoprocessing tools &gt; Dissolve</strong>. Dissolve the <strong>Intersection</strong> layerby country name. Set the Intersection layer as <strong>Input layer</strong> and select the dissolve field (<strong>SOVEREIGNT</strong>) by clicking the button next to <strong>Dissolve field(s)</strong>. Save the results to for example your course directory and name the result descriptively (for example nile_dissolved.gpkg).  Now press <strong>Run</strong> and then <strong>Close</strong>. </p>
<p><img src="img/exercise_7/image5.png" /></p>
<p>You can easily copy a pre-configured layer style for a new layer. Right click the layer with the style you want to copy (intersection) and select <strong>Styles &gt; Copy style &gt; All style categories</strong>. Then right click the layer we just created and select <strong>Styles &gt; Paste style &gt; All style categories</strong>.</p>
<p><img src="img/exercise_7/image6.png" /></p>
<p>Once you enable the <strong>Show Feature Count</strong> the result should look like this:</p>
<p><img src="img/exercise_7/image7.png" /></p>
<p>To top our analysis off we can calculate how much of the length of the Nile each country has. Let's start by calculating the length for every dissolved line. Open the attribute table, enable editing (with the pencil icon) and open the field calculator. Select <strong>Create a new field</strong>, and name it as length. Now calculate the lengths with the <strong>$length</strong> function found in the <strong>Geometry</strong> section. Set the field length to integer so we get the lengths with 1 meter precision.</p>
<p><img src="img/exercise_7/image8.png" /></p>
<p>You can view statistical information about your layers with the <strong>Statistical Summary Panel</strong> (click the <strong>Show Statistical Summary</strong> <img src="img/exercise_7/image9.png" /> button in the top toolbar). Select the layer you want to examine (nile_dissolved in this case), and from the drop-down below menu select the <strong>length</strong> field. The panel displays useful information about the selected field, such as the feature count and the min, max and mean values.</p>
<p><img src="img/exercise_7/image10.png" /></p>
<p>Finally, let's calculate how many percentages of Nile each country has. Open the <strong>Field calculator</strong>  once again, select <strong>Create new field</strong> and calculate the percentage values as follows:</p>
<p><img src="img/exercise_7/image11.png" /></p>
<div class="code-box">
<p>“length”/sum(“length”) * 100</p>
</div>
<p>Since we are using the <strong>sum()</strong> function instead of the absolute value, our percentages would change automatically if the lengths changed.</p>
<p>Once you are done, save the project file into the course directory either by selecting <strong>Project &gt; Save</strong> from the menu bar or by pressing <strong>CTRL + S</strong>.</p>

</div>
</div>
<p style="text-align: center;">
<a href="06_exercise_6.html"><button class="btn btn-default">Previous</button></a>
<a href="08_exercise_8.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>

<footer class="footer text-center">

<div class="footer-container text-center">

<div class="footer-info">
<h5 class="footer-title">Introduction to QGIS</h5>
<span class="footer-version">v2024-01-18</span>
<div class="license"><img src="img/by-nd.svg" width="80px" alt="CC-BY-ND"></div>
</div>

<div class="footer-info">
<h5 class="footer-title footer-company">Gispo Ltd.
<span class="footer-copyright-year">© 2024</span></h5>
<span class="footer-contact-info">Kumpulantie 3, 3 krs
<br>00520 Helsinki, Finland
<br>info@gispo.fi
</span>
</div>

</div>
</div>
</footer>
</div>


<script src="js/nav-script.js"></script>
<script src="js/answer-key.js"></script>

</body>
</html>
