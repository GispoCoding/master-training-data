<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<link rel="icon" href="/master-training-data/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/master-training-data/favicon.ico" type="image/x-icon">

<!-- Based on TemplateMo 553 Xtra Blog: https://templatemo.com/tm-553-xtra-blog -->

<meta name="robots" content="noindex, nofollow" />
<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="EXERCISE 1.7: SPATIAL DATABASES | Introduction to GeoServer" />
<meta property="og:type" content="book" />





<meta name="author" content="Gispo Oy" />

<meta name="date" content="2024-01-18" />


<meta name="description" content="EXERCISE 1.7: SPATIAL DATABASES | Introduction to GeoServer">

<title>EXERCISE 1.7: SPATIAL DATABASES | Introduction to GeoServer</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="custom.css" type="text/css" />

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/hamburgers.css" rel="stylesheet">

</head>

<body>


<div class="main-content">
<!-- special comment to mark beginning of title section for bookdown -->
<!-- bookdown comments must be in this order: title, toc, body -->

<div class="main-content-wrapper">

<div class="row">
<div class="col-sm-12">
<header class="main-toc sidebar" id="sidebar">
<div class="sidebar-wrapper">

<button class="navbar-toggle hamburger hamburger--collapse" id="navbar-toggle"
type="button" onclick="navToggle()" aria-label="Toggle navigation">
<span class="hamburger-box"><span class="hamburger-inner"></span></span>
</button>

<div class="sidebar-title-wrapper">
<img alt="Logo" width="100" src="img/gispo_white_sm.png" class="sidebar-logo">
<div class="sidebar-title"><h1>Introduction to GeoServer</h1></div>
<div class="abstract-sidebar"><p>A course covering basic GeoServer topics.</p></div>
</div>

<nav class="sidebar-nav">
<div id="TOC" class="toc">
<ul>
<li class="has-sub"><a href="index.html#introduction-to-geoserver">INTRODUCTION TO GEOSERVER</a>
<ul>
<li><a href="index.html#welcome-to-this-geoserver-course">Welcome to this GeoServer Course!</a></li>
<li><a href="index.html#background-of-geoserver">Background of GeoServer</a></li>
<li><a href="index.html#how-to-read">How to read</a></li>
<li><a href="index.html#additional-information">Additional information</a></li>
<li><a href="index.html#mistakes">Mistakes</a></li>
<li><a href="index.html#license-and-permissions">License and permissions</a></li>
</ul></li>
<li class="has-sub"><a href="01_exercise_1.html#exercise-1.1-installation-and-commissioning">EXERCISE 1.1: INSTALLATION AND COMMISSIONING</a>
<ul>
<li><a href="01_exercise_1.html#preparation"><strong>Preparation</strong></a></li>
<li class="has-sub"><a href="01_exercise_1.html#main-menu"><strong>Main menu</strong></a>
<ul>
<li><a href="01_exercise_1.html#about-geoserver"><strong>About GeoServer</strong></a></li>
<li><a href="01_exercise_1.html#layer-preview"><strong>Layer Preview</strong></a></li>
<li><a href="01_exercise_1.html#service-capabilities"><strong>Service Capabilities</strong></a></li>
<li><a href="01_exercise_1.html#demos"><strong>Demos</strong></a></li>
<li><a href="01_exercise_1.html#demo-requests"><strong>Demo requests</strong></a></li>
</ul></li>
<li><a href="01_exercise_1.html#srs-list-ja-reprojection-console"><strong>SRS List ja Reprojection console</strong></a></li>
<li><a href="01_exercise_1.html#wcs-request-builder"><strong>WCS request builder</strong></a></li>
</ul></li>
<li class="has-sub"><a href="02_exercise_2.html#exercise-1.2-geoserver-web-interface">EXERCISE 1.2: GEOSERVER WEB INTERFACE</a>
<ul>
<li><a href="02_exercise_2.html#preparation-1"><strong>Preparation</strong></a></li>
<li><a href="02_exercise_2.html#administrators-interface"><strong>Administrator’s interface</strong></a></li>
<li><a href="02_exercise_2.html#master-and-administrator-users"><strong>Master and Administrator users</strong></a></li>
<li class="has-sub"><a href="02_exercise_2.html#about-status-settings"><strong>About &amp; Status settings</strong></a>
<ul>
<li><a href="02_exercise_2.html#contact-information"><strong>Contact Information</strong></a></li>
<li><a href="02_exercise_2.html#server-status"><strong>Server Status</strong></a></li>
<li><a href="02_exercise_2.html#geoserver-logs"><strong>GeoServer Logs</strong></a></li>
</ul></li>
<li class="has-sub"><a href="02_exercise_2.html#data-menu"><strong>Data menu</strong></a>
<ul>
<li><a href="02_exercise_2.html#layer-preview-1"><strong>Layer Preview</strong></a></li>
<li><a href="02_exercise_2.html#workspaces"><strong>Workspaces</strong></a></li>
<li><a href="02_exercise_2.html#stores"><strong>Stores</strong></a></li>
<li><a href="02_exercise_2.html#layers"><strong>Layers</strong></a></li>
</ul></li>
<li><a href="02_exercise_2.html#layer-groups"><strong>Layer Groups</strong></a></li>
<li><a href="02_exercise_2.html#styles"><strong>Styles</strong></a></li>
<li><a href="02_exercise_2.html#settings"><strong>Settings</strong></a></li>
<li><a href="02_exercise_2.html#tile-caching-1"><strong>Tile Caching</strong></a></li>
<li><a href="02_exercise_2.html#security-1"><strong>Security</strong></a></li>
</ul></li>
<li class="has-sub"><a href="03_exercise_3.html#exercise-1.3-vector-data">Exercise 1.3: VECTOR DATA</a>
<ul>
<li><a href="03_exercise_3.html#preparation-2"><strong>Preparation</strong></a></li>
<li><a href="03_exercise_3.html#creating-vector-data-store"><strong>Creating vector data store</strong></a></li>
<li><a href="03_exercise_3.html#publishing-vector-layer"><strong>Publishing vector layer</strong></a></li>
<li class="has-sub"><a href="03_exercise_3.html#data-settings"><strong>Data settings</strong></a>
<ul>
<li><a href="03_exercise_3.html#coordinate-reference-systems"><strong>Coordinate Reference Systems</strong></a></li>
<li><a href="03_exercise_3.html#bounding-boxes"><strong>Bounding Boxes</strong></a></li>
<li><a href="03_exercise_3.html#feature-type-details"><strong>Feature Type Details</strong></a></li>
</ul></li>
<li><a href="03_exercise_3.html#add-helsinki-road-network"><strong>Add Helsinki road network</strong></a></li>
</ul></li>
<li class="has-sub"><a href="04_exercise_4.html#exercise-1.4-basics-of-styling-sld">EXERCISE 1.4: BASICS OF STYLING (SLD)</a>
<ul>
<li><a href="04_exercise_4.html#preparation-3"><strong>Preparation</strong></a></li>
<li><a href="04_exercise_4.html#geoserverin-styling-technique"><strong>GeoServerin styling technique</strong></a></li>
<li><a href="04_exercise_4.html#sld-styling"><strong>SLD-styling</strong></a></li>
<li><a href="04_exercise_4.html#creating-a-new-style"><strong>Creating a new style</strong></a></li>
<li><a href="04_exercise_4.html#deployment-of-sld-styling-technique"><strong>Deployment of SLD styling technique</strong></a></li>
<li><a href="04_exercise_4.html#sld-cookbook"><strong>SLD Cookbook</strong></a></li>
<li><a href="04_exercise_4.html#editing-sld-styling-technique"><strong>Editing SLD styling technique</strong></a></li>
<li><a href="04_exercise_4.html#create-a-road-style"><strong>Create a road style</strong></a></li>
</ul></li>
<li class="has-sub"><a href="05_exercise_5.html#exercise-1.5-wms-and-wcs-services">EXERCISE 1.5: WMS AND WCS SERVICES</a>
<ul>
<li><a href="05_exercise_5.html#preparation-4"><strong>Preparation</strong></a></li>
<li><a href="05_exercise_5.html#ogc-standards"><strong>OGC-standards</strong></a></li>
<li><a href="05_exercise_5.html#general-map-service-settings"><strong>General map service settings</strong></a></li>
<li><a href="05_exercise_5.html#wms"><strong>WMS</strong></a></li>
<li><a href="05_exercise_5.html#workspace-specific-server-settings"><strong>Workspace-specific server settings</strong></a></li>
<li><a href="05_exercise_5.html#dpi-resolution-of-the-wms-map-service-image"><strong>DPI resolution of the WMS map service image</strong></a></li>
<li><a href="05_exercise_5.html#wcs"><strong>WCS</strong></a></li>
</ul></li>
<li class="has-sub"><a href="06_exercise_6.html#exercise-1.6-raster-data">EXERCISE 1.6: RASTER DATA</a>
<ul>
<li><a href="06_exercise_6.html#preparation-5"><strong>Preparation</strong></a></li>
<li><a href="06_exercise_6.html#adding-raster-data"><strong>Adding raster data</strong></a></li>
<li><a href="06_exercise_6.html#adding-an-aerial-image"><strong>Adding an aerial image</strong></a></li>
<li><a href="06_exercise_6.html#image-mosaic"><strong>Image Mosaic</strong></a></li>
<li class="has-sub"><a href="06_exercise_6.html#layer-groups-1"><strong>Layer Groups</strong></a>
<ul>
<li><a href="06_exercise_6.html#form-of-publication-of-group-layers"><strong>Form of publication of group layers</strong></a></li>
<li><a href="06_exercise_6.html#use-of-external-wms-services-cascading-wms"><strong>Use of external WMS services (cascading WMS)</strong></a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="07_exercise_7.html#exercise-1.7-spatial-databases">EXERCISE 1.7: SPATIAL DATABASES</a>
<ul>
<li><a href="07_exercise_7.html#preparation-6"><strong>Preparation</strong></a></li>
<li><a href="07_exercise_7.html#connecting-to-the-geodatabase"><strong>Connecting to the geodatabase</strong></a></li>
<li><a href="07_exercise_7.html#adding-a-postgis-layer"><strong>Adding a PostGIS layer</strong></a></li>
<li><a href="07_exercise_7.html#adding-a-polygon-and-line-layer-from-postgis-database"><strong>Adding a polygon and line layer from PostGIS database</strong></a></li>
<li><a href="07_exercise_7.html#setting-default-styles-for-layers"><strong>Setting default styles for layers</strong></a></li>
<li><a href="07_exercise_7.html#sql-views"><strong>SQL views</strong></a></li>
<li><a href="07_exercise_7.html#geographical-data-functions-via-sql-views"><strong>Geographical data functions via SQL views</strong></a></li>
</ul></li>
<li class="has-sub"><a href="08_exercise_8.html#exercise-2.1-wfs-services">EXERCISE 2.1: WFS SERVICES</a>
<ul>
<li><a href="08_exercise_8.html#preparation-7"><strong>Preparation</strong></a></li>
<li><a href="08_exercise_8.html#ogc-standards-1"><strong>OGC-standards</strong></a></li>
<li><a href="08_exercise_8.html#wfs-settings"><strong>WFS settings</strong></a></li>
<li><a href="08_exercise_8.html#number-of-data-requested"><strong>Number of data requested</strong></a></li>
<li><a href="08_exercise_8.html#specifying-several-coordinate-systems"><strong>Specifying several coordinate systems</strong></a></li>
<li><a href="08_exercise_8.html#service-levels"><strong>Service Levels</strong></a></li>
<li><a href="08_exercise_8.html#gml-settings"><strong>GML settings</strong></a></li>
<li><a href="08_exercise_8.html#workspace-specific-settings"><strong>Workspace specific settings</strong></a></li>
<li><a href="08_exercise_8.html#editing-via-wfs-t-service"><strong>Editing via WFS-T service</strong></a></li>
</ul></li>
<li class="has-sub"><a href="09_exercise_9.html#exercise-2.2-map-tile-services">EXERCISE 2.2: MAP TILE SERVICES</a>
<ul>
<li><a href="09_exercise_9.html#preparation-8"><strong>Preparation</strong></a></li>
<li><a href="09_exercise_9.html#tile-caching-2"><strong>Tile Caching</strong></a></li>
<li><a href="09_exercise_9.html#geowebcache-user-interface"><strong>GeoWebCache user interface</strong></a></li>
<li><a href="09_exercise_9.html#layer-specific-settings"><strong>Layer-specific settings</strong></a></li>
<li><a href="09_exercise_9.html#pre-creation-of-map-tiles"><strong>Pre-creation of map tiles</strong></a></li>
<li><a href="09_exercise_9.html#using-the-hard-disk-of-the-map-tiles"><strong>Using the hard disk of the map tiles</strong></a></li>
<li><a href="09_exercise_9.html#map-tile-grids"><strong>Map tile grids</strong></a></li>
<li><a href="09_exercise_9.html#map-tile-grid-according-to-jhs180"><strong>Map tile grid according to JHS180</strong></a></li>
<li><a href="09_exercise_9.html#creating-a-new-gridset"><strong>Creating a new gridset</strong></a></li>
<li><a href="09_exercise_9.html#finlands-openstreetmap-road-network"><strong>Finland’s OpenStreetMap road network</strong></a></li>
<li><a href="09_exercise_9.html#using-your-own-map-tile-grid"><strong>Using your own map tile grid</strong></a></li>
<li><a href="09_exercise_9.html#create-a-local-map-tile-grid"><strong>Create a local map tile grid</strong></a></li>
</ul></li>
<li class="has-sub"><a href="10_exercise_10.html#exercise-2.3-architecture-and-deployment">EXERCISE 2.3: ARCHITECTURE AND DEPLOYMENT</a>
<ul>
<li><a href="10_exercise_10.html#preparation-9"><strong>Preparation</strong></a></li>
<li><a href="10_exercise_10.html#general-information-about-the-geoserver-server"><strong>General information about the GeoServer server</strong></a></li>
<li><a href="10_exercise_10.html#image-processing-settings"><strong>Image Processing Settings</strong></a></li>
<li><a href="10_exercise_10.html#raster-access"><strong>Raster Access</strong></a></li>
<li><a href="10_exercise_10.html#geoservers-log"><strong>GeoServer’s log</strong></a></li>
<li><a href="10_exercise_10.html#rest-api-functionality"><strong>REST API functionality</strong></a></li>
<li><a href="10_exercise_10.html#using-the-monitor-plugin-tarkista-nämä-vielä"><strong>Using the Monitor plugin (tarkista nämä vielä)</strong></a></li>
</ul></li>
<li class="has-sub"><a href="11_exercise_11.html#exercise-2.4-css-styling">EXERCISE 2.4: CSS-STYLING</a>
<ul>
<li><a href="11_exercise_11.html#preparation-10"><strong>Preparation</strong></a></li>
<li><a href="11_exercise_11.html#css-styles"><strong>CSS-styles</strong></a></li>
<li><a href="11_exercise_11.html#creating-a-style"><strong>Creating a style</strong></a></li>
<li><a href="11_exercise_11.html#classification-of-data"><strong>Classification of data</strong></a></li>
<li><a href="11_exercise_11.html#tuning-the-style"><strong>Tuning the style</strong></a></li>
<li><a href="11_exercise_11.html#category-naming"><strong>Category naming</strong></a></li>
<li><a href="11_exercise_11.html#multi-scale-visibility"><strong>Multi-scale visibility</strong></a></li>
<li><a href="11_exercise_11.html#adding-subtitles"><strong>Adding subtitles</strong></a></li>
<li><a href="11_exercise_11.html#application-of-styling-technology"><strong>Application of styling technology</strong></a></li>
</ul></li>
<li class="has-sub"><a href="12_exercise_12.html#exercise-2.5-access-control">EXERCISE 2.5: ACCESS CONTROL</a>
<ul>
<li><a href="12_exercise_12.html#geoserver-general-security-settings"><strong>GeoServer general security settings</strong></a></li>
<li><a href="12_exercise_12.html#identification"><strong>Identification</strong></a></li>
<li><a href="12_exercise_12.html#create-a-new-role-and-user"><strong>Create a new role and user</strong></a></li>
<li><a href="12_exercise_12.html#limiting-access-rights-to-the-data"><strong>Limiting access rights to the data</strong></a></li>
<li><a href="12_exercise_12.html#user-specific-access-rights-for-the-data"><strong>User-specific access rights for the data</strong></a></li>
</ul></li>
<li class="has-sub"><a href="13_exercise_13.html#exercise-2.6-filtering">EXERCISE 2.6: FILTERING</a>
<ul>
<li><a href="13_exercise_13.html#filtering-with-attributes">Filtering with attributes</a></li>
</ul></li>
</ul>
</div>
</nav>
</div>
</header>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="exercise-1.7-spatial-databases" class="section level1">
<h1>EXERCISE 1.7: SPATIAL DATABASES</h1>
<p><strong>Content of the exercise</strong></p>
<p>The exercise involves adding data to GeoServer from a database source.</p>
<p><strong>Aim of the exercise</strong></p>
<p>After the exercise, the student will be able to connect geodatabase data to GeoServer and publish their data there.</p>
<p><strong>Estimated duration</strong></p>
<p>30 minutes.</p>
<div id="preparation-6" class="section level2">
<h2><strong>Preparation</strong></h2>
<p>Start a web browser on your computer and log in for your practice session.</p>
<p>The PostgreSQL database and its PostGIS extension are installed on the server machine. The database is pre-loaded with a variety of vector data.</p>
</div>
<div id="connecting-to-the-geodatabase" class="section level2">
<h2><strong>Connecting to the geodatabase</strong></h2>
<p>GeoServer supports most spatial databases, including PostGIS, ArcSDE, Oracle and Microsoft SQL Server.</p>
<p>PostGIS spatial databases can be automatically accessed through GeoServer’s default settings. Support for other databases is installed via plugins.</p>
<p>A PostGIS database is pre-installed in the training environment, with a variety of vector datasets ready for use. The data are from <strong>Helsinki Region Infoshare</strong>, <strong>University of Jyväskylä open data services</strong> and <strong>OpenStreetMap map data</strong> (from geofabrik.de).</p>
<p>As with other datasets, in order to use them in GeoServer, they must be referenced by creating an appropriate store.</p>
<p>Create a new store (<strong>Data → Stores → Add new Store</strong>).</p>
<p>Select the format <strong>PostGIS - PostGIS Database</strong>: <img src="img/harjoitus_7/image1.2.png" /></p>
<p>Select the <strong>helsinki</strong> workspace as <strong>Workspace</strong> and name it <strong>hki_lipas</strong> (<strong>Data Source Name</strong>).</p>
<p>Then fill in the <strong>Connection Parameters</strong> of the PostGIS database as follows:</p>
<table style="width:49%;">
<colgroup>
<col width="29%" />
<col width="19%" />
</colgroup>
<tbody>
<tr class="odd">
<td><h5 id="dbtype"><strong>Dbtype</strong></h5></td>
<td>postgis</td>
</tr>
<tr class="even">
<td><h5 id="host"><strong>Host</strong></h5></td>
<td>localhost</td>
</tr>
<tr class="odd">
<td><h5 id="port"><strong>Port</strong></h5></td>
<td>5432</td>
</tr>
<tr class="even">
<td><h5 id="database"><strong>Database</strong></h5></td>
<td>gs_training</td>
</tr>
<tr class="odd">
<td><h5 id="schema"><strong>Schema</strong></h5></td>
<td>lipas</td>
</tr>
<tr class="even">
<td><h5 id="user"><strong>User</strong></h5></td>
<td>postgres</td>
</tr>
<tr class="odd">
<td><h5 id="passwd"><strong>Passwd</strong></h5></td>
<td>gispo</td>
</tr>
</tbody>
</table>
<p>Leave the rest of the settings as defaults and press <strong>Save</strong>. <img src="img/harjoitus_7/image2.2.png" /></p>
<p>In the same way as before, the new layer creation view will appear automatically after creating a store. This view lists all the layers that can be found in that database.</p>
<p>The data is now referenced via the <strong>hki_lipas</strong> store and you can see what data it contains: <img src="img/harjoitus_7/image3.png" /></p>
</div>
<div id="adding-a-postgis-layer" class="section level2">
<h2><strong>Adding a PostGIS layer</strong></h2>
<p>You can publish a layer immediately after creating a store by pressing <strong>Publish</strong>. Now publish the <strong>pisteet (points)</strong> layer. Lipas is a national geographic information system for physical education managed by the University of Jyväskylä.</p>
<div class="hint-box">
<p>Psst! When you later want to publish other layers from the hki_HRI-store, you can do it from the main menu Data → Layers → Add a new layers and select the desired store.</p>
</div>
<p>In the editing view of a layer, the layer name and title are automatically filled in. Keep the default names and add additional information in the <strong>Abstract</strong> field if you wish.</p>
<p>Check that <strong>Enabled</strong> and <strong>Advertised</strong> are checked.</p>
<p>As you will have noticed by now, the settings for the new layer are the same, whether it is a shapefile format or a PostGIS database.</p>
<p>In the <strong>Coordinate Reference Systems</strong> section, check that GeoServer has identified <strong>EPSG:3067</strong> as the coordinate system. PostGIS and GeoServer use EPSG codes to determine the coordinate system, so in most cases the coordinate system will be correctly determined automatically. <img src="img/harjoitus_7/image4.png" /></p>
<p>Before saving the publishing settings for a layer, configure the <strong>Bounding Boxes</strong> layer in the same way as you did with the data you added earlier. <img src="img/harjoitus_7/image5.png" /></p>
<p>Finally, press <strong>Save</strong>. You can preview the new layer via <strong>Layer Preview</strong>.<br />
<img src="img/harjoitus_7/image6.png" /></p>
</div>
<div id="adding-a-polygon-and-line-layer-from-postgis-database" class="section level2">
<h2><strong>Adding a polygon and line layer from PostGIS database</strong></h2>
<p>Add two more layers from the PostGIS database in the same way:</p>
<ul>
<li><p><strong>alueet (areas)</strong></p></li>
<li><p><strong>reitit (routes)</strong></p></li>
</ul>
<p>Remember that you can add layers via <strong>Data → Layers → Add new layer</strong> and by selecting <strong>helsinki:hki_lipas</strong> as source. Then preview these layers to check their functionality.</p>
<div class="hint-box">
<p>Which steps are mandatory to publish a layer? What are the coordinate systems of the layers and their scopes?</p>
</div>
</div>
<div id="setting-default-styles-for-layers" class="section level2">
<h2><strong>Setting default styles for layers</strong></h2>
<p>Finally, change the default styles for those layers using GeoServer’s default styles. You can change the layer style from the main menu <strong>Data → Layers</strong> and open the layer you want to change. The styles are defined in the <strong>Publish</strong> tab. Use the following styles:</p>
<table style="width:44%;">
<colgroup>
<col width="22%" />
<col width="22%" />
</colgroup>
<tbody>
<tr class="odd">
<td><h3 id="layer"><strong>Layer</strong></h3></td>
<td><h3 id="style"><strong>Style</strong></h3></td>
</tr>
<tr class="even">
<td><strong>pisteet</strong></td>
<td>burg</td>
</tr>
<tr class="odd">
<td><strong>alueet</strong></td>
<td>giant_polygon</td>
</tr>
<tr class="even">
<td><strong>reitit</strong></td>
<td>simple_roads</td>
</tr>
</tbody>
</table>
<p>Finally, you can make the data into a group layer. In the picture, the Helsinki background map group layer and the lipas data have been combined into one map service layer: <img src="img/harjoitus_7/image7.png" /></p>
</div>
<div id="sql-views" class="section level2">
<h2><strong>SQL views</strong></h2>
<p>GeoServer also allows SQL queries to be used to share spatial data sets.</p>
<p>Let’s add again <strong>lipas_kaikki_reitit</strong> data as a new layer on the server. The goal is to create a layer where only data from Helsinki is displayed.</p>
<p>I will name it <strong>lipas_kaikki_reitit_helsinki</strong>.</p>
<div class="hint-box">
<p>Psst! An SQL view could also be created directly in the database and use that view to create a layer.</p>
</div>
<p>To perform SQL queries, it is a good idea to first find out the names and types of the fields in the database tables. You can check the fields in the data by opening a layer in the <strong>Data → Layers</strong> view; the fields are listed at the end of the <strong>Data</strong> tab. The types of attribute data in the dataset are best viewed using other software such as pgAdmin or QGIS. You can also check them out on the Lipas website (<a href="http://www.liikuntapaikat.fi/lipas" class="uri">http://www.liikuntapaikat.fi/lipas</a>).</p>
<p>The attribute data in GeoServer looks like this:</p>
<p><img src="img/harjoitus_7/image8.png" /></p>
<p>After examining the data, it can be concluded that the location information can be found in the <strong>municipality_name</strong> field.</p>
<p>Open <strong>Data → Layers → Add new layer</strong> and select <strong>helsinki:hki_lipas</strong>. Press <strong>Configure new SQL view…</strong> to configure in SQL which data you want to publish from this dataset. (päivitä kuva jos onnistuu taulujen nimeäminen englanniksi)<img src="img/harjoitus_7/image9.png" /></p>
<p>Define the view name as <strong>lipas_kaikki_reitit_helsinki</strong>. Enter the following SQL query in the <strong>SQL statement</strong> field:</p>
<div class="code-box">
<p>SELECT *</p>
<p>FROM lipas.reitit</p>
<p>WHERE kunta_nimi = ‘Helsinki’</p>
</div>
<p>Check the <strong>Guess geometry type and srid</strong> option and then press <strong>Refresh</strong>. Please note that there is an error in the SQL query in the image below. Pay attention! Instead of the kunta_nimi_fi text, it should just read kunta_nimi. <img src="img/harjoitus_7/image10.png" /></p>
<p>Then check that <strong>SRID</strong> in the <strong>geom</strong> field is specified with the correct EPSG identifier (in our case <strong>3067</strong>).</p>
<p><img src="img/harjoitus_7/image11.png" /></p>
<p>Then press <strong>Save</strong>.</p>
<p>Next, define the dimensions of the layer (Bounding Box) and press <strong>Save</strong>. You can now preview the Helsinki liikuntareitit layer. <img src="img/harjoitus_7/image12.png" /></p>
</div>
<div id="geographical-data-functions-via-sql-views" class="section level2">
<h2><strong>Geographical data functions via SQL views</strong></h2>
<p>You can also use spatial functions in SQL queries. The zone function (ST_Buffer) is used as an example.</p>
<p>Reopen layer <strong>lipas_kaikki_reitit_helsinki</strong> (<strong>Data → Layers</strong>)</p>
<p>In the <strong>Data</strong> tab, scroll to the bottom of the page. There you will find the <strong>Edit SQL view</strong> function.</p>
<p>Update the <strong>SQL statement</strong> next:</p>
<div class="code-box">
<p>SELECT ST_Union (ST_Buffer ( geom, 10 ))</p>
<p>FROM lipas.reitit</p>
<p>WHERE kunta_nimi = ‘Helsinki’</p>
</div>
<p>Update the format of the attributes again and then press <strong>Save</strong>. <img src="img/harjoitus_7/image13.png" /></p>
<p>In the preview, you will notice that the route data is now buffered by 10 metres: <img src="img/harjoitus_7/image14.png" /></p>

</div>
</div>
<p style="text-align: center;">
<a href="06_exercise_6.html"><button class="btn btn-default">Previous</button></a>
<a href="08_exercise_8.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>

<footer class="footer text-center">

<div class="footer-container text-center">

<div class="footer-info">
<h5 class="footer-title">Introduction to GeoServer</h5>
<span class="footer-version">v2024-01-18</span>
<div class="license"><img src="img/by-nd.svg" width="80px" alt="CC-BY-ND"></div>
</div>

<div class="footer-info">
<h5 class="footer-title footer-company">Gispo Ltd.
<span class="footer-copyright-year">© 2024</span></h5>
<span class="footer-contact-info">Kumpulantie 3, 3 krs
<br>00520 Helsinki, Finland
<br>info@gispo.fi
</span>
</div>

</div>
</div>
</footer>
</div>


<script src="js/nav-script.js"></script>
<script src="js/answer-key.js"></script>

</body>
</html>
