<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<link rel="icon" href="/master-training-data/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/master-training-data/favicon.ico" type="image/x-icon">

<!-- Based on TemplateMo 553 Xtra Blog: https://templatemo.com/tm-553-xtra-blog -->

<meta name="robots" content="noindex, nofollow" />
<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Harjoitus 5: Python-konsoli | Tilastot ja analyysit QGISillä" />
<meta property="og:type" content="book" />





<meta name="author" content="Gispo Oy." />

<meta name="date" content="2024-01-18" />


<meta name="description" content="Harjoitus 5: Python-konsoli | Tilastot ja analyysit QGISillä">

<title>Harjoitus 5: Python-konsoli | Tilastot ja analyysit QGISillä</title>




<link rel="stylesheet" href="custom.css" type="text/css" />

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/hamburgers.css" rel="stylesheet">

</head>

<body>


<div class="main-content">
<!-- special comment to mark beginning of title section for bookdown -->
<!-- bookdown comments must be in this order: title, toc, body -->

<div class="main-content-wrapper">

<div class="row">
<div class="col-sm-12">
<header class="main-toc sidebar" id="sidebar">
<div class="sidebar-wrapper">

<button class="navbar-toggle hamburger hamburger--collapse" id="navbar-toggle"
type="button" onclick="navToggle()" aria-label="Toggle navigation">
<span class="hamburger-box"><span class="hamburger-inner"></span></span>
</button>

<div class="sidebar-title-wrapper">
<img alt="Logo" width="100" src="img/gispo_white_sm.png" class="sidebar-logo">
<div class="sidebar-title"><h1>Tilastot ja analyysit QGISillä</h1></div>
<div class="abstract-sidebar"><p>Jatkokurssi QGISin käytöstä.</p></div>
</div>

<nav class="sidebar-nav">
<div id="TOC" class="toc">
<ul>
<li class="has-sub"><a href="index.html#tilastot-ja-analyysit-qgisillä">Tilastot ja analyysit QGISillä</a>
<ul>
<li><a href="index.html#tervetuloa-qgis-jatkokurssille">Tervetuloa QGIS-jatkokurssille!</a></li>
<li><a href="index.html#kurssimateriaalien-lataaminen">Kurssimateriaalien lataaminen</a></li>
<li><a href="index.html#lukuohje">Lukuohje</a></li>
<li><a href="index.html#mistä-lisätietoja">Mistä lisätietoja?</a></li>
<li><a href="index.html#virheet">Virheet</a></li>
<li><a href="index.html#lisenssi-ja-oikeudet">Lisenssi ja oikeudet</a></li>
</ul></li>
<li class="has-sub"><a href="01_harjoitus_1.html#harjoitus-1-qgis-käyttöliittymän-konfigurointi">Harjoitus 1: QGIS-käyttöliittymän konfigurointi</a>
<ul>
<li><a href="01_harjoitus_1.html#valmistautuminen">Valmistautuminen</a></li>
<li><a href="01_harjoitus_1.html#käyttöliittymän-räätälöinti">Käyttöliittymän räätälöinti</a></li>
<li><a href="01_harjoitus_1.html#muokkauksen-yleisasetukset">Muokkauksen yleisasetukset</a></li>
<li><a href="01_harjoitus_1.html#käyttäjäprofiilit">Käyttäjäprofiilit</a></li>
<li><a href="01_harjoitus_1.html#pikanäppäimet">Pikanäppäimet</a></li>
<li><a href="01_harjoitus_1.html#taustakarttoja-lisäosien-avulla">Taustakarttoja lisäosien avulla</a></li>
</ul></li>
<li class="has-sub"><a href="02_harjoitus_2.html#harjoitus-2-taulukosta-kartalle">Harjoitus 2: Taulukosta kartalle</a>
<ul>
<li><a href="02_harjoitus_2.html#valmistautuminen-1">Valmistautuminen</a></li>
<li><a href="02_harjoitus_2.html#pisteet-tekstitiedostosta-kartalle">Pisteet tekstitiedostosta kartalle</a></li>
<li><a href="02_harjoitus_2.html#ilman-geometriaa-olevan-taulukon-tuominen">Ilman geometriaa olevan taulukon tuominen</a></li>
<li><a href="02_harjoitus_2.html#taulukon-kenttien-tyypin-muokkaaminen">Taulukon kenttien tyypin muokkaaminen</a></li>
<li><a href="02_harjoitus_2.html#taulukkotiedon-liittäminen-geometriaan">Taulukkotiedon liittäminen geometriaan</a></li>
</ul></li>
<li class="has-sub"><a href="03_harjoitus_3.html#harjoitus-3-vektorianalyysi">Harjoitus 3: Vektorianalyysi</a>
<ul>
<li><a href="03_harjoitus_3.html#valmistautuminen-2">Valmistautuminen</a></li>
<li><a href="03_harjoitus_3.html#vektorianalyysi">Vektorianalyysi</a></li>
<li><a href="03_harjoitus_3.html#tilastot">Tilastot</a></li>
<li><a href="03_harjoitus_3.html#valinta-toisen-tason-sijainnin-perusteella">Valinta toisen tason sijainnin perusteella</a></li>
<li><a href="03_harjoitus_3.html#dataplotly-lisäosa">DataPlotly-lisäosa</a></li>
<li><a href="03_harjoitus_3.html#kohteiden-etäisyys-toisen-tason-pisteistä">Kohteiden etäisyys toisen tason pisteistä</a></li>
<li><a href="03_harjoitus_3.html#pisteiden-lukumäärä">Pisteiden lukumäärä</a></li>
<li><a href="03_harjoitus_3.html#aggregointi-ja-sulautus">Aggregointi ja sulautus</a></li>
<li><a href="03_harjoitus_3.html#uusien-kenttien-laskeminen">Uusien kenttien laskeminen</a></li>
<li><a href="03_harjoitus_3.html#päivittyvät-arvot">Päivittyvät arvot</a></li>
<li><a href="03_harjoitus_3.html#etsi-omia-analyysityökaluja">Etsi omia analyysityökaluja</a></li>
</ul></li>
<li class="has-sub"><a href="04_harjoitus_4.html#harjoitus-4-graafinen-mallintaja">Harjoitus 4: Graafinen mallintaja</a>
<ul>
<li><a href="04_harjoitus_4.html#valmistautuminen-3">Valmistautuminen</a></li>
<li><a href="04_harjoitus_4.html#graafisen-mallintajan-toiminnot">Graafisen mallintajan toiminnot</a></li>
<li><a href="04_harjoitus_4.html#prosessin-laatiminen-ja-testaus">Prosessin laatiminen ja testaus</a></li>
<li><a href="04_harjoitus_4.html#tallennetun-prosessin-käyttöönotto">Tallennetun prosessin käyttöönotto</a></li>
</ul></li>
<li class="has-sub"><a href="05_harjoitus_5.html#harjoitus-5-python-konsoli">Harjoitus 5: Python-konsoli</a>
<ul>
<li><a href="05_harjoitus_5.html#valmistautuminen-4">Valmistautuminen</a></li>
<li><a href="05_harjoitus_5.html#python-konsolin-perusteet">Python-konsolin perusteet</a></li>
<li><a href="05_harjoitus_5.html#python-skriptien-ajaminen-globe-builder--lisäosan-komentojen-hyödyntäminen">Python-skriptien ajaminen: Globe Builder -lisäosan komentojen hyödyntäminen</a></li>
<li><a href="05_harjoitus_5.html#tee-bufferi-hyödyntäen-python-skriptiä">Tee bufferi hyödyntäen Python-skriptiä</a></li>
</ul></li>
</ul>
</div>
</nav>
</div>
</header>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="harjoitus-5-python-konsoli" class="section level1">
<h1>Harjoitus 5: Python-konsoli</h1>
<p><strong>Harjoituksen sisältö</strong></p>
<p>Harjoituksessa tutustutaan QGISin toiminnallisuuksien laajentamiseen Python-konsolin avulla.</p>
<p><strong>Harjoituksen tavoite</strong></p>
<p>Koulutettava oppii hyödyntämään Python-konsolia ja etsiä verkosta ohjelmointikoodeja siihen.</p>
<p><strong>Arvioitu kesto</strong></p>
<p>30 minuuttia.</p>
<div id="valmistautuminen-4" class="section level2">
<h2>Valmistautuminen</h2>
<p>Avaa uusi QGIS-projekti (<strong>Projekti &gt; Uusi</strong>) ja tallenna se nimellä <strong>“QGIS-harjoitus 5”</strong>. Lisää projektiin seuraavat aineistot:</p>
<ul>
<li><strong>..kurssihakemisto/HSY/HSY_vaestotietoruudukko_2019.gpkg</strong></li>
</ul>
</div>
<div id="python-konsolin-perusteet" class="section level2">
<h2>Python-konsolin perusteet</h2>
<p>QGISin Python-konsolin avulla voit automatisoida useita paikkatietoprosesseja QGISissä. Käytännössä pystyt nopeuttamaan useiden paikkatietoprosessien toimittamista opiskelemalla Python-ohjelmointikieltä sekä QGIS-kohtaisten PyQGIS-komentojen käyttöä.</p>
<p>Python on ohjelmointikieli, joka on paikkatieto-ohjelmistojen lisäksi kasvavasti käytössä eri toimialoilla. Pythonia kutsutaankin niin sanotusti lingua francaksi, sillä sen käyttötapaukset ulottuvat niin laajalle ja sen käyttöönotto ohjelmointikielenä on verrattain nopeaa. QGISissä Pythonia voi hyödyntää eri tavoilla. Niistä tärkeimmät alla:</p>
<ul>
<li><p>Python-kielen avulla voidaan <strong>automatisoida</strong> monia paikkatiedon prosessointiin ja analysointiin liittyviä <strong>toimintoja</strong>. Tämä nopeuttaa, helpottaa ja parantaa paikkatiedon käsittelyä.</p></li>
<li><p>Python-kielen avulla voidaan lisätä <strong>toistettavuutta</strong> paikkatietoprosesseissa. Näin Python-komentoja seuraamalla kuka vain voi toistaa paikkatietoprosessin jälkikäteen.  </p></li>
<li><p>Python-kielen avulla voidaan tuottaa <strong>QGIS-lisäosia</strong> (eng. plugins) organisaation tai laajempien työprosessien ratkaisemiksi.</p></li>
<li><p>Python-kielen avulla voidaan tuottaa <strong>prosessointialgoritmeja</strong> (eng. processing algorithms). Näillä algoritmeilla viitataan Python-skripteihin, jotka tallennetaan QGISiin ja niistä tulee omia pientyökaluja esim. paikkatietojen prosessoinnin tehtävien toteuttamiseen.</p></li>
</ul>
<p>QGISissa Pythonin käyttö pohjautuu ennen kaikkea QGISin Python-konsoliin, jolla voidaan ajaa Python-komentoja. Avaa konsoli klikkaamalla <img src="img/harjoitus_5/image1.png" /> tai valikosta menemällä <strong>Lisäosat &gt; Python-konsoli</strong>.</p>
<p><img src="img/harjoitus_5/image2.png" /></p>
<p>Konsoli aukenee karttaikkunan alapuolelle.</p>
<p><img src="img/harjoitus_5/image3.png" /></p>
<p><strong>Python-konsolissa</strong> voit ajaa normaalia Python-koodia. Syötä ja aja ensimmäiseksi seuraava koodi:</p>
<div class="code-box">
<p>print(‘Gispo loves FOSS4G’)</p>
</div>
<p><img src="img/harjoitus_5/image4.png" /></p>
</div>
<div id="python-skriptien-ajaminen-globe-builder--lisäosan-komentojen-hyödyntäminen" class="section level2">
<h2>Python-skriptien ajaminen: Globe Builder -lisäosan komentojen hyödyntäminen</h2>
<p>Käyttötapauksissa, joissa nähdään hyödylliseksi Python-ohjelmointikielen hyödyntäminen QGISissä, voidaan etsiä verkosta hakukoneen avulla (esim. Google) valmiita Python-skriptejä QGISiin.</p>
<p>Ajetaan nyt yksi Python-skripti, niin näet miten Python-skriptejä voi ajaa QGISissä. Tässä haluamme nopeuttaa työprosessia, joten hyödynnämme Python-skriptiä tuottamaan karttavisualisoinnin QGISissä. Olet ehkä jo nähnyt Gispon toteuttaman <a href="https://github.com/GispoCoding/GlobeBuilder">Globe Builder -lisäosan</a>, jota kokeilemme nyt Python-konsolin kautta.</p>
<p><img src="img/harjoitus_5/image5.png" /></p>
<p>Lisäosaa käytetään pääasiallisesti lisäosan käyttöliittymän avulla. Käyttöliittymässä määritetään valintoja visualisaation tuottamiseksi. Haluamme nyt tuottaa maapallon muotoisen karttavisualisoinnin hyödyntäen Python-skriptiä käyttämättä lisäosan käyttöliittymää. Näin voimme mahdollisesti nopeuttaa toimiamme. Tämä olisi myös hyödyllistä mikäli tekisimme usean iteraation karttavisualisaation toteuttamiseksi tai jos hyödyntäisimme lisäosan toiminnallisuuksia osana jotakin muuta tietojärjestelmää, joka komentopohjaisesti voisi komentaa QGISiä toteuttamaan karttavisualisoinnin. Näin voisimme automatisoida työprosessejamme, minkä lisäksi kuka tahansa voi toistaa komentopohjaisen työprosessimme.</p>
<p>Voimme nähdä haluamme koodin <a href="https://gist.github.com/Joonalai/7b8693ef904df75cb15cb9af0e82c032">GitHubista</a>, mutta se löytyy myös kurssihakemistosta <strong>Muuta-kansion</strong> alta nimellä <strong>globeBuilder.py</strong>. Kyseessä on tekstitiedosto, johon on tallennettu Python-ohjelmointikielellä muutama toiminallisuus GlobeBuilderiin liittyen.</p>
<p>Avaa nyt kyseinen tiedosto QGISissä Python-konsoliin, konsolin koodi-editorin puolelle eli oikealle:</p>
<p><img src="img/harjoitus_5/image6.png" /></p>
<p>Kyseessä on lista erilaisia Python-komentoja, jotka tallennamme QGISiin ajamalla tekstitiedoston sisällön <img src="img/harjoitus_5/image7.png" />-painikkeesta. Klikkaa painiketta, joka ajaa koko komentosarjan kertaheitolla:</p>
<p><img src="img/harjoitus_5/image8.png" /></p>
<p>Aja nyt tiedoston omien ohjeiden (keltaisella) mukaisesti <strong>load_natural_earth_data()-komento</strong> konsolin puolella:</p>
<p><img src="img/harjoitus_5/image9.png" /></p>
<p>Huomaa: hyödynnettäesi load_natural_earth_data()-komentoa QGIS lataa ikään kuin automaattisesti verkosta datan ja visualisoi sen suoraan QGISissäsi. Näin näemmekin karttanäkymässämme metodin lataaman <strong>Natural Earth -aineiston</strong>:</p>
<p><img src="img/harjoitus_5/image10.png" /></p>
<p>Kokeile myös lisäosan muita toiminnallisuuksia suoraan Python-konsolista. Tutkittuasi kyseistä tekstitiedostoa löydät useamman eri toiminnallisuuden, joita tutkimalla opit hiukan Pythonin hyödyntämisestä QGISissä. Kokeile esim. vaihtaa karttanäkymän taustaväriä mustaksi:</p>
<div class="code-box">
<p>change_background_color(color=QtCore.Qt.black)</p>
</div>
<p>Lue lisää komentojen hyödyntämisestä ja esimerkeistä <a href="https://github.com/GispoCoding/GlobeBuilder">lisäosan GitHub-repositoriosta</a>.</p>
</div>
<div id="tee-bufferi-hyödyntäen-python-skriptiä" class="section level2">
<h2>Tee bufferi hyödyntäen Python-skriptiä</h2>
<p>Kuvittele nyt toinen paikkatiedon käyttötapaus, jossa haluat tehdä väestötietoruudukolle sisäisen bufferin seuraavan näytönkaappauksen mukaisesti:</p>
<p><img src="img/harjoitus_5/image11.png" /></p>
<p>Skriptin avulla voidaan tuottaa sisäinen buffer-taso väestötietoruudukolle tai jollekin muulle polygon-aineistolle käyttämättä erinäisiä käyttöliittymään pohjautuvia työkaluja bufferin toteuttamiseen. Lisäksi voi nähdä mahdollisuutena kuvitella monivaiheisen paikkatietoprosessin, jonka yhdessä vaiheessa on toteutettava sisäinen buffer aineistolle. Myös tämänkaltaisissa työprosesseissa kyseisestä skriptistä olisi huomattavasti hyötyä.</p>
<p>Avaa <strong>buffer.py-tiedosto Muuta-kansion</strong> alta:</p>
<p><img src="img/harjoitus_5/image12.png" /></p>
<p>Tarkastele koodia ja huomioi, että tiedostopolut viittaavat kurssikansioosi. Koodissa on kommentteina eri komentojen toiminnot, lue ne ja kysy kouluttajalta tarvittaessa lisätietoa.</p>
<p>Ennen skriptin ajamista varmista, että sinulla on <strong>vaestotietoruudukko_2019-taso</strong> valittuna tasoluettelossa ja koodin alussa oikea tuloshakemisto valittuna. Sinun pitää muokata tuloshakemisto oman kansiorakenteesi mukaiseksi. </p>
<p><img src="img/harjoitus_5/image13.png" /></p>
<p>Aja koodi nyt painamalla editorin yllä olevaa <strong>Suorita-painiketta</strong>. Varmista, että viimeinen komento suoritetaan painamalla rivinvaihtoa. Lopputulos on koodin määrittelemällä paksuudella laskettu puskuritaso.</p>
<p>Kun olet valmis, tallenna projektitiedosto kurssihakemistoon pikanäppäimellä <strong>CTRL + T</strong> tai päävalikosta <strong>Projekti &gt; Tallenna</strong>.</p>
<div class="hint-box">
<p>Psst! Koulutuksen jälkeen saat henkilökohtaista tukea Gispon tukipalvelusta. Lähetä kysymyksesi tai kommenttisi osoitteeseen tuki@gispo.fi!</p>
</div>

</div>
</div>
<p style="text-align: center;">
<a href="04_harjoitus_4.html"><button class="btn btn-default">Previous</button></a>
</p>
</div>
</div>

<footer class="footer text-center">

<div class="footer-container text-center">

<div class="footer-info">
<h5 class="footer-title">Tilastot ja analyysit QGISillä</h5>
<span class="footer-version">v2024-01-18</span>
<div class="license"><img src="img/by-nd.svg" width="80px" alt="CC-BY-ND"></div>
</div>

<div class="footer-info">
<h5 class="footer-title footer-company">Gispo Oy.
<span class="footer-copyright-year">© 2023</span></h5>
<span class="footer-contact-info">Kumpulantie 3, 3 krs
<br>00520 Helsinki, Finland
<br>info@gispo.fi
</span>
</div>

</div>
</div>
</footer>
</div>


<script src="js/nav-script.js"></script>
<script src="js/answer-key.js"></script>

</body>
</html>
